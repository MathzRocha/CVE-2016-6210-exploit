# CVE-2016-6210-exploit
Custom exploit written for enumerating usernames as per CVE-2016-6210 (OpenSSH 7.3 & prior)

_ONLY USE THIS CODE ON SYSTEMS IN WHICH YOU ARE AUTHORISED TO DO THIS ON_

## DESCRIPTION

I wrote this program as a tool to exploit CVE-2016-6210, which is a vulnerability in OpenSSH (before version 7.3) [disclosed by Eddie Harari](https://vuldb.com/?id.89622)

From what I understand, the problem is that the way OpenSSH worked in these versions means that when given a large password (in this case 25kb),
the hashing processing times mean that we can tell whether a username exists or not, as the amount of time is higher for valid users

This program helps to exploit this vulnerability by allowing the user to send a number of usernames (from a wordlist), and work out how long it took
to process them. The user can set an alert for an amount of time that suits them, and the time and username will be displayed if the processing time exceeds
this. The user can also add an email in order to test both the item in the list with and without the email addon at the end.

Credit goes to Eddie Harari for some of the code in `cveCode.py`: a modified version of Harari's code is used for sending and 
testing response times. His advisory and sample code can be found [here](https://seclists.org/fulldisclosure/2016/Jul/51)

_Note: My code has only been black-box tested on OpenSSH-7.2p2, and needs further testing. However, it functions as intended, and the results and parameters
are controlled and open to be interpreted by the user_

_P.S: This program is written in python 2.7 as the original code was written in it, and I'm too lazy to redo it_

## USAGE

`python exploit_6210.py IP_ADDRESS [-h] [-a ALERT] [-w WORDLIST] [-e EMAIL]`

Where:

- IP_ADDRESS		is the host that you are testing the program against

- -a ALERT (optional, default is 0.1)  is the amount of time (in seconds) for which you would like an alert to be made if the processing time is larger

- -w WORDLIST (optional, default is usernamelist) is the filepath for the list of usernames you would like to test against the host

- -e EMAIL (optional) is the email (which should look like: @email.com) you would like to try on the end of each element in the wordlist (note that both the item AND the item + email will be tried) 